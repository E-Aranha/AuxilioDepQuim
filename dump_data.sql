CREATE TABLE TERCEIROS(
    NUCPFCNPJ CHAR(14),
    TIPO VARCHAR(15),
    CONSTRAINT PK_TERCEIROS PRIMARY KEY(NUCPFCNPJ)  
    --Realizar o check pra tratar cpf e cnpj
);

CREATE TABLE PESSOA_FISICA(
    CPF CHAR(14),
    NOME VARCHAR(30),
    CONSTRAINT PK_PESSOA_FISICA PRIMARY KEY(CPF),
    CONSTRAINT FK_PESSOA_FISICA FOREIGN KEY(CPF) 
        REFERENCES TERCEIROS(NUCPFCNPJ) 
        ON DELETE CASCADE
);

CREATE TABLE DOADOR(
    CPF CHAR(14),
    CONSTRAINT PK_DOADOR PRIMARY KEY (CPF),
    CONSTRAINT FK_DOADOR FOREIGN KEY(CPF)
        REFERENCES PESSOA_FISICA(CPF) 
        ON DELETE CASCADE
);


CREATE TABLE TIPO_PESSOA_FISICA(            
    CPF CHAR(14),
    TIPOPF VARCHAR(11),
    CONSTRAINT PK_TIPO_PESSOA_FISICA PRIMARY KEY(CPF, TIPOPF),
    CONSTRAINT FK_TIPO_PESSOA_FISICA FOREIGN KEY(CPF)
        REFERENCES PESSOA_FISICA(CPF)
        ON DELETE CASCADE
);


CREATE TABLE FUNCIONARIO(
    CPF CHAR(14),
    CENTRO_COMUNITARIO CHAR(14) NOT NULL,
    CONSTRAINT PK_FUNCIONARIO PRIMARY KEY(CPF), 
    CONSTRAINT FK_FUNCIONARIO FOREIGN KEY(CPF)
        REFERENCES PESSOA_FISICA(CPF)
        ON DELETE CASCADE
);

CREATE TABLE CENTRO(
    CNPJ CHAR(14),
    CAIXA REAL,
    LOCAL VARCHAR(65),
    PRESIDENTE CHAR(14) NOT NULL,
    CONSTRAINT PK_CENTRO PRIMARY KEY(CNPJ),
    CONSTRAINT FK_CENTRO FOREIGN KEY(PRESIDENTE)
        REFERENCES FUNCIONARIO(CPF)
        ON DELETE CASCADE,
    CONSTRAINT UN_CENTRO UNIQUE(PRESIDENTE)
);

ALTER TABLE FUNCIONARIO ADD
CONSTRAINT FK_FUNCIONARIO_CENTRO FOREIGN KEY(CENTRO_COMUNITARIO)
    REFERENCES CENTRO(CNPJ) 
    ON DELETE CASCADE;

CREATE TABLE DOACAO(
    NOTA_FISCAL CHAR(9),
    CENTRO CHAR(14) NOT NULL,
    TERCEIRO CHAR(14) NOT NULL,
    FINALIDADE VARCHAR(400),
    VALOR REAL,
    TIPO_PRODUTO VARCHAR(50),
    CONSTRAINT PK_DOACAO PRIMARY KEY(NOTA_FISCAL),
    CONSTRAINT FK_DOACAO FOREIGN KEY(TERCEIRO)
        REFERENCES TERCEIROS(NUCPFCNPJ)
        ON DELETE CASCADE,
    CONSTRAINT FK2_DOACAO FOREIGN KEY(CENTRO)
        REFERENCES CENTRO(CNPJ)
        ON DELETE CASCADE
);

CREATE TABLE EVENTOS(
    DATA  DATE,
    LOCAL VARCHAR(65),
    NOME  CHAR(30),
    CENTRO_COMUNITARIO CHAR(14) NOT NULL , 
    CONSTRAINT PK_EVENTOS PRIMARY KEY(DATA,LOCAL,NOME),
    CONSTRAINT FK_EVENTOS FOREIGN KEY(CENTRO_COMUNITARIO)
        REFERENCES CENTRO(CNPJ) 
        ON DELETE CASCADE
);


CREATE TABLE ONG(
    CNPJ CHAR(14),
    CAUSA_SOCIAL VARCHAR(400),
    CONSTRAINT PK_ONG PRIMARY KEY(CNPJ),
    CONSTRAINT FK_ONG FOREIGN KEY(CNPJ)
        REFERENCES TERCEIROS(NUCPFCNPJ)
        ON DELETE CASCADE   
);

CREATE TABLE EMPRESAS_PARCEIRAS(
    CNPJ CHAR(14),
    NUFUNCIONARIOS INTEGER,
    MAXFUNCIONARIOS INTEGER,
    CONSTRAINT PK_EMPRESAS_PARCEIRAS PRIMARY KEY(CNPJ),
    CONSTRAINT FK_EMPRESAS_PARCEIRAS FOREIGN KEY(CNPJ)
        REFERENCES TERCEIROS(NUCPFCNPJ) 
        ON DELETE CASCADE
);


CREATE TABLE FRENTE(
    NOME VARCHAR(65),
    CENTRO CHAR(14),
    TIPO VARCHAR(30),
    NRO_FUNCIONARIOS INTEGER,
    CONSTRAINT PK_FRENTE PRIMARY KEY(NOME, CENTRO),
    CONSTRAINT FK_FRENTE FOREIGN KEY(CENTRO)
        REFERENCES CENTRO(CNPJ)
        ON DELETE CASCADE
);

CREATE TABLE TESOURARIA(
    FRENTE VARCHAR(65),
    CENTRO CHAR(14),
    CONSTRAINT PK_TESOURARIA PRIMARY KEY(FRENTE,CENTRO),
    CONSTRAINT FK_TESOURARIA FOREIGN KEY(FRENTE,CENTRO)
        REFERENCES FRENTE(NOME,CENTRO)
        ON DELETE CASCADE
);

CREATE TABLE REESTRUTURACAO_PROFISSIONAL(
    FRENTE VARCHAR(65),
    CENTRO CHAR(14),
    CONSTRAINT PK_REESTRUTURACAO_PROFISSIONAL PRIMARY KEY(FRENTE,CENTRO),
    CONSTRAINT FK_REESTRUTURACAO_PROFISSIONAL FOREIGN KEY(FRENTE,CENTRO)
        REFERENCES FRENTE(NOME,CENTRO)
        ON DELETE CASCADE
);

CREATE TABLE REESTRUTURACAO_SOCIAL(
    FRENTE VARCHAR(65),
    CENTRO CHAR(14),
    CONSTRAINT PK_REESTRUTURACAO_SOCIAL PRIMARY KEY(FRENTE,CENTRO),
    CONSTRAINT FK_REESTRUTURACAO_SOCIAL FOREIGN KEY(FRENTE,CENTRO)
        REFERENCES FRENTE(NOME,CENTRO)
        ON DELETE CASCADE
);

CREATE TABLE COMUNICACAO(
    FRENTE VARCHAR(65),
    CENTRO CHAR(14),
    CONSTRAINT PK_COMUNICACAO PRIMARY KEY(FRENTE,CENTRO),
    CONSTRAINT FK_COMUNICACAO FOREIGN KEY(FRENTE,CENTRO)
        REFERENCES FRENTE(NOME,CENTRO)
        ON DELETE CASCADE
);

CREATE TABLE AUXILIADO(
    CPF CHAR(14),
    NOME VARCHAR(30) NOT NULL,
    DATA_NASC DATE,
    SEXO CHAR(1),
    LOCAL VARCHAR(65),
    FRENTE VARCHAR(65),
    CENTRO CHAR(14),
    CONSTRAINT PK_AUXILIADO PRIMARY KEY(CPF),
    CONSTRAINT FK_AUXILIADO_FRENTE FOREIGN KEY(FRENTE,CENTRO)
        REFERENCES TESOURARIA(FRENTE,CENTRO)
        ON DELETE SET NULL
    
);

CREATE TABLE TIPO_AUXILIADO(
    CPF CHAR(14),
    TIPO CHAR(20),
    CONSTRAINT PK_TIPO_AUXILIADO PRIMARY KEY(CPF,TIPO),
    CONSTRAINT FK_TIPO_AUXILIADO FOREIGN KEY(CPF)
        REFERENCES AUXILIADO(CPF)
        ON DELETE CASCADE
);


CREATE TABLE MORADOR_DE_RUA(
    CPF CHAR(14),
    ONG CHAR(14),
    CONSTRAINT PK_MORADOR_DE_RUA PRIMARY KEY(CPF),
    CONSTRAINT FK_MORADOR_DE_RUA FOREIGN KEY(CPF)
        REFERENCES AUXILIADO(CPF)
        ON DELETE CASCADE,
    CONSTRAINT FK_MORADOR_DE_RUA2 FOREIGN KEY(ONG)
        REFERENCES ONG(CNPJ)
        ON DELETE CASCADE
);


CREATE TABLE DEPENDENTE_QUIMICO(
    CPF CHAR(14),
    CONSTRAINT PK_DEPENDENTE_QUIMICO PRIMARY KEY(CPF),
    CONSTRAINT FK_DEPENDENTE_QUIMICO FOREIGN KEY(CPF)
        REFERENCES AUXILIADO(CPF)
        ON DELETE CASCADE
);

CREATE TABLE VICIOS_DEPENDENTE(
    CPF CHAR(14),
    VICIO VARCHAR(25),
    CONSTRAINT PK_VICIOS_DEPENDENTE PRIMARY KEY(CPF, VICIO),
    CONSTRAINT FK_VICIOS_DEPENDENTE FOREIGN KEY(CPF)
        REFERENCES DEPENDENTE_QUIMICO(CPF)
        ON DELETE CASCADE
    
);


CREATE TABLE HABILIDADES(
    AUXILIADO CHAR(14),
    EXPERIENCIA CHAR(30),
    CONSTRAINT PK_HABILIDADES PRIMARY KEY(AUXILIADO,EXPERIENCIA),
    CONSTRAINT FK_HABILIDADES FOREIGN KEY(AUXILIADO)
        REFERENCES AUXILIADO(CPF)
        ON DELETE CASCADE
);

CREATE TABLE CLINICA(
    CNPJ CHAR(14),
    NOME VARCHAR(30),
    NUMERO_FUNC INTEGER,
    NUMERO_PACIENTES INTEGER,
    NUMERO_MAX_PACIENTES INTEGER,
    CONSTRAINT PK_CLINICA PRIMARY KEY(CNPJ)
);

CREATE TABLE REABILITACAO(
    DEPENDENTE CHAR (14),
    FRENTE  VARCHAR(65),
    CENTRO  CHAR(14),
    DATA_REAB DATE,
    PRESENCA REAL,
    CLINICA CHAR(14) NOT NULL,
    CONSTRAINT PK_REABILITACAO PRIMARY KEY(DEPENDENTE,FRENTE,CENTRO,DATA_REAB),
    CONSTRAINT FK_REABILITACAO FOREIGN KEY(DEPENDENTE)
        REFERENCES DEPENDENTE_QUIMICO(CPF)
        ON DELETE CASCADE,
    CONSTRAINT FK_REABILITACAO2 FOREIGN KEY(FRENTE,CENTRO)
        REFERENCES REESTRUTURACAO_SOCIAL(FRENTE,CENTRO)
        ON DELETE CASCADE,
    CONSTRAINT FK_REABILITACAO3 FOREIGN KEY(CLINICA)
        REFERENCES CLINICA(CNPJ)
        ON DELETE CASCADE
);


CREATE TABLE EMPREGO_SUPERVISIONADO(
    AUXILIADO CHAR(14),
    FRENTE VARCHAR(65),
    CENTRO CHAR(14),
    EMPRESA_PARCEIRA CHAR(14),
    LOCAL VARCHAR(65),
    DURACAO INTEGER,
    CONSTRAINT PK_EMPREGO_SUPERVISIONADO PRIMARY KEY(AUXILIADO, FRENTE, CENTRO, EMPRESA_PARCEIRA),
    CONSTRAINT FK_EMPREGO_CENTRO FOREIGN KEY(FRENTE, CENTRO) 
        REFERENCES REESTRUTURACAO_PROFISSIONAL(FRENTE, CENTRO) 
        ON DELETE CASCADE,
    CONSTRAINT FK_EMPREGO_EMPRESA FOREIGN KEY(EMPRESA_PARCEIRA)
        REFERENCES EMPRESAS_PARCEIRAS(CNPJ)
        ON DELETE CASCADE
);

-- FINISHED TABLE --

INSERT INTO TERCEIROS (NUCPFCNPJ,TIPO) VALUES ('00011111111111','GAP');
INSERT INTO TERCEIROS (NUCPFCNPJ,TIPO) VALUES ('11100000000000','ALO');